import{g as S}from"./vite-plugin-node-polyfills-9f21ca85.js";function A(){}class P{constructor(e=1/0,t=A){this.max=e,this.dispose=t,this.map=new Map,this.newest=null,this.oldest=null}has(e){return this.map.has(e)}get(e){const t=this.getNode(e);return t&&t.value}get size(){return this.map.size}getNode(e){const t=this.map.get(e);if(t&&t!==this.newest){const{older:s,newer:i}=t;i&&(i.older=s),s&&(s.newer=i),t.older=this.newest,t.older.newer=t,t.newer=null,this.newest=t,t===this.oldest&&(this.oldest=i)}return t}set(e,t){let s=this.getNode(e);return s?s.value=t:(s={key:e,value:t,newer:null,older:this.newest},this.newest&&(this.newest.newer=s),this.newest=s,this.oldest=this.oldest||s,this.map.set(e,s),s.value)}clean(){for(;this.oldest&&this.map.size>this.max;)this.delete(this.oldest.key)}delete(e){const t=this.map.get(e);return t?(t===this.newest&&(this.newest=t.older),t===this.oldest&&(this.oldest=t.newer),t.newer&&(t.newer.older=t.older),t.older&&(t.older.newer=t.newer),this.map.delete(e),this.dispose(t.value,e),!0):!1}}function h(){}const N=h,v=typeof WeakRef<"u"?WeakRef:function(n){return{deref:()=>n}},M=typeof WeakMap<"u"?WeakMap:Map,x=typeof FinalizationRegistry<"u"?FinalizationRegistry:function(){return{register:h,unregister:h}},C=10024;class q{constructor(e=1/0,t=N){this.max=e,this.dispose=t,this.map=new M,this.newest=null,this.oldest=null,this.unfinalizedNodes=new Set,this.finalizationScheduled=!1,this.size=0,this.finalize=()=>{const s=this.unfinalizedNodes.values();for(let i=0;i<C;i++){const o=s.next().value;if(!o)break;this.unfinalizedNodes.delete(o);const a=o.key;delete o.key,o.keyRef=new v(a),this.registry.register(a,o,o)}this.unfinalizedNodes.size>0?queueMicrotask(this.finalize):this.finalizationScheduled=!1},this.registry=new x(this.deleteNode.bind(this))}has(e){return this.map.has(e)}get(e){const t=this.getNode(e);return t&&t.value}getNode(e){const t=this.map.get(e);if(t&&t!==this.newest){const{older:s,newer:i}=t;i&&(i.older=s),s&&(s.newer=i),t.older=this.newest,t.older.newer=t,t.newer=null,this.newest=t,t===this.oldest&&(this.oldest=i)}return t}set(e,t){let s=this.getNode(e);return s?s.value=t:(s={key:e,value:t,newer:null,older:this.newest},this.newest&&(this.newest.newer=s),this.newest=s,this.oldest=this.oldest||s,this.scheduleFinalization(s),this.map.set(e,s),this.size++,s.value)}clean(){for(;this.oldest&&this.size>this.max;)this.deleteNode(this.oldest)}deleteNode(e){e===this.newest&&(this.newest=e.older),e===this.oldest&&(this.oldest=e.newer),e.newer&&(e.newer.older=e.older),e.older&&(e.older.newer=e.newer),this.size--;const t=e.key||e.keyRef&&e.keyRef.deref();this.dispose(e.value,t),e.keyRef?this.registry.unregister(e):this.unfinalizedNodes.delete(e),t&&this.map.delete(t)}delete(e){const t=this.map.get(e);return t?(this.deleteNode(t),!0):!1}scheduleFinalization(e){this.unfinalizedNodes.add(e),this.finalizationScheduled||(this.finalizationScheduled=!0,queueMicrotask(this.finalize))}}let r=null;const w={};let O=1;const R=()=>class{constructor(){this.id=["slot",O++,Date.now(),Math.random().toString(36).slice(2)].join(":")}hasValue(){for(let e=r;e;e=e.parent)if(this.id in e.slots){const t=e.slots[this.id];if(t===w)break;return e!==r&&(r.slots[this.id]=t),!0}return r&&(r.slots[this.id]=w),!1}getValue(){if(this.hasValue())return r.slots[this.id]}withValue(e,t,s,i){const o={__proto__:null,[this.id]:e},a=r;r={parent:a,slots:o};try{return t.apply(i,s)}finally{r=a}}static bind(e){const t=r;return function(){const s=r;try{return r=t,e.apply(this,arguments)}finally{r=s}}}static noContext(e,t,s){if(r){const i=r;try{return r=null,e.apply(s,t)}finally{r=i}}else return e.apply(s,t)}};function p(n){try{return n()}catch{}}const u="@wry/context:Slot",D=p(()=>globalThis)||p(()=>S)||Object.create(null),y=D,G=y[u]||Array[u]||function(n){try{Object.defineProperty(y,u,{value:n,enumerable:!1,writable:!1,configurable:!0})}finally{return n}}(R()),{toString:g,hasOwnProperty:F}=Object.prototype,k=Function.prototype.toString,f=new Map;function L(n,e){try{return d(n,e)}finally{f.clear()}}function d(n,e){if(n===e)return!0;const t=g.call(n),s=g.call(e);if(t!==s)return!1;switch(t){case"[object Array]":if(n.length!==e.length)return!1;case"[object Object]":{if(j(n,e))return!0;const i=m(n),o=m(e),a=i.length;if(a!==o.length)return!1;for(let l=0;l<a;++l)if(!F.call(e,i[l]))return!1;for(let l=0;l<a;++l){const c=i[l];if(!d(n[c],e[c]))return!1}return!0}case"[object Error]":return n.name===e.name&&n.message===e.message;case"[object Number]":if(n!==n)return e!==e;case"[object Boolean]":case"[object Date]":return+n==+e;case"[object RegExp]":case"[object String]":return n==`${e}`;case"[object Map]":case"[object Set]":{if(n.size!==e.size)return!1;if(j(n,e))return!0;const i=n.entries(),o=t==="[object Map]";for(;;){const a=i.next();if(a.done)break;const[l,c]=a.value;if(!e.has(l)||o&&!d(c,e.get(l)))return!1}return!0}case"[object Uint16Array]":case"[object Uint8Array]":case"[object Uint32Array]":case"[object Int32Array]":case"[object Int8Array]":case"[object Int16Array]":case"[object ArrayBuffer]":n=new Uint8Array(n),e=new Uint8Array(e);case"[object DataView]":{let i=n.byteLength;if(i===e.byteLength)for(;i--&&n[i]===e[i];);return i===-1}case"[object AsyncFunction]":case"[object GeneratorFunction]":case"[object AsyncGeneratorFunction]":case"[object Function]":{const i=k.call(n);return i!==k.call(e)?!1:!T(i,I)}}return!1}function m(n){return Object.keys(n).filter(W,n)}function W(n){return this[n]!==void 0}const I="{ [native code] }";function T(n,e){const t=n.length-e.length;return t>=0&&n.indexOf(e,t)===t}function j(n,e){let t=f.get(n);if(t){if(t.has(e))return!0}else f.set(n,t=new Set);return t.add(e),!1}const V=()=>Object.create(null),{forEach:_,slice:K}=Array.prototype,{hasOwnProperty:U}=Object.prototype;class b{constructor(e=!0,t=V){this.weakness=e,this.makeData=t}lookup(...e){return this.lookupArray(e)}lookupArray(e){let t=this;return _.call(e,s=>t=t.getChildTrie(s)),U.call(t,"data")?t.data:t.data=this.makeData(K.call(e))}peek(...e){return this.peekArray(e)}peekArray(e){let t=this;for(let s=0,i=e.length;t&&s<i;++s){const o=this.weakness&&z(e[s])?t.weak:t.strong;t=o&&o.get(e[s])}return t&&t.data}getChildTrie(e){const t=this.weakness&&z(e)?this.weak||(this.weak=new WeakMap):this.strong||(this.strong=new Map);let s=t.get(e);return s||t.set(e,s=new b(this.weakness,this.makeData)),s}}function z(n){switch(typeof n){case"object":if(n===null)break;case"function":return!0}return!1}export{P as S,b as T,q as W,G as a,L as e};
